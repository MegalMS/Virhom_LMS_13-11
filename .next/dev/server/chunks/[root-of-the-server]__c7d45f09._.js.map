{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/pc/Desktop/LMS-Front%20Site/my-tailwind-app/app/api/auth/%5B...nextauth%5D/route.js"],"sourcesContent":["import NextAuth from \"next-auth\";\r\nimport GoogleProvider from \"next-auth/providers/google\";\r\n\r\nexport const authOptions = {\r\n  providers: [\r\n    GoogleProvider({\r\n      clientId: process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, account, profile }) {\r\n      if (account && profile) {\r\n        try {\r\n          const backendResponse = await fetch(\r\n            `${process.env.NEXT_PUBLIC_API_URL}/api/auth/google`,\r\n            {\r\n              method: \"POST\",\r\n              headers: { \"Content-Type\": \"application/json\" },\r\n              body: JSON.stringify({\r\n                token: account.id_token,\r\n                role: \"member\",\r\n              }),\r\n            }\r\n          );\r\n          if (backendResponse.ok) {\r\n            const backendData = await backendResponse.json();\r\n            token.backendToken = backendData.token;\r\n            token.backendUser = backendData.user;\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Backend authentication error:\", error);\r\n        }\r\n      }\r\n      return token;\r\n    },\r\n\r\n    async session({ session, token }) {\r\n      session.backendToken = token.backendToken;\r\n      session.backendUser = token.backendUser;\r\n      return session;\r\n    },\r\n\r\n    // âœ… Force redirect to LAN IP after successful login\r\n    async redirect({ url, baseUrl }) {\r\n      const lanBase = \"http://10.27.1.244:3000\";\r\n\r\n      // Handle default NextAuth redirects\r\n      if (url.startsWith(\"/\")) return `${lanBase}${url}`;\r\n\r\n      // Replace localhost in URL with LAN IP\r\n      if (url.startsWith(\"http://localhost:3000\")) {\r\n        return url.replace(\"http://localhost:3000\", lanBase);\r\n      }\r\n\r\n      return lanBase; // fallback\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: \"/login\",\r\n    error: \"/login\",\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n  debug: process.env.NODE_ENV === \"development\",\r\n};\r\n\r\nconst handler = NextAuth(authOptions);\r\nexport { handler as GET, handler as POST };\r\n\r\n\r\n// import NextAuth from \"next-auth\";\r\n// import GoogleProvider from \"next-auth/providers/google\";\r\n\r\n\r\n// export const authOptions = {\r\n//   providers: [\r\n//     GoogleProvider({\r\n//       clientId: process.env.GOOGLE_CLIENT_ID,\r\n//       clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n//     }),\r\n//   ],\r\n//   callbacks: {\r\n//     async jwt({ token, account, profile }) {\r\n//       // Initial sign in\r\n//       if (account && profile) {\r\n//         try {\r\n//           // Send Google token to your backend\r\n//           const backendResponse = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/auth/google`, {\r\n//             method: \"POST\",\r\n//             headers: {\r\n//               \"Content-Type\": \"application/json\",\r\n//             },\r\n//             body: JSON.stringify({\r\n//               token: account.id_token,\r\n//               role: \"member\", // You can make this dynamic\r\n//             }),\r\n//           });\r\n\r\n//           if (backendResponse.ok) {\r\n//             const backendData = await backendResponse.json();\r\n//             token.backendToken = backendData.token;\r\n//             token.backendUser = backendData.user;\r\n//           } else {\r\n//             console.error(\"Backend auth failed:\", await backendResponse.text());\r\n//           }\r\n//         } catch (error) {\r\n//           console.error(\"Backend authentication error:\", error);\r\n//         }\r\n//       }\r\n//       return token;\r\n//     },\r\n//     async session({ session, token }) {\r\n//       session.backendToken = token.backendToken;\r\n//       session.backendUser = token.backendUser;\r\n//       return session;\r\n//     },\r\n//   },\r\n//   pages: {\r\n//     signIn: \"/login\",\r\n//     error: \"/login\",\r\n//   },\r\n//   debug: process.env.NODE_ENV === \"development\",\r\n//   secret: process.env.NEXTAUTH_SECRET,\r\n// };\r\n\r\n// const handler = NextAuth(authOptions);\r\n// export { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEO,MAAM,cAAc;IACzB,WAAW;QACT,IAAA,gKAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;QAChD;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;YACnC,IAAI,WAAW,SAAS;gBACtB,IAAI;oBACF,MAAM,kBAAkB,MAAM,MAC5B,+DAAmC,gBAAgB,CAAC,EACpD;wBACE,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BACnB,OAAO,QAAQ,QAAQ;4BACvB,MAAM;wBACR;oBACF;oBAEF,IAAI,gBAAgB,EAAE,EAAE;wBACtB,MAAM,cAAc,MAAM,gBAAgB,IAAI;wBAC9C,MAAM,YAAY,GAAG,YAAY,KAAK;wBACtC,MAAM,WAAW,GAAG,YAAY,IAAI;oBACtC;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,iCAAiC;gBACjD;YACF;YACA,OAAO;QACT;QAEA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,QAAQ,YAAY,GAAG,MAAM,YAAY;YACzC,QAAQ,WAAW,GAAG,MAAM,WAAW;YACvC,OAAO;QACT;QAEA,oDAAoD;QACpD,MAAM,UAAS,EAAE,GAAG,EAAE,OAAO,EAAE;YAC7B,MAAM,UAAU;YAEhB,oCAAoC;YACpC,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO,GAAG,UAAU,KAAK;YAElD,uCAAuC;YACvC,IAAI,IAAI,UAAU,CAAC,0BAA0B;gBAC3C,OAAO,IAAI,OAAO,CAAC,yBAAyB;YAC9C;YAEA,OAAO,SAAS,WAAW;QAC7B;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACnC,OAAO,oDAAyB;AAClC;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC;;CAIzB,oCAAoC;CACpC,2DAA2D;CAG3D,+BAA+B;CAC/B,iBAAiB;CACjB,uBAAuB;CACvB,gDAAgD;CAChD,wDAAwD;CACxD,UAAU;CACV,OAAO;CACP,iBAAiB;CACjB,+CAA+C;CAC/C,2BAA2B;CAC3B,kCAAkC;CAClC,gBAAgB;CAChB,iDAAiD;CACjD,wGAAwG;CACxG,8BAA8B;CAC9B,yBAAyB;CACzB,oDAAoD;CACpD,iBAAiB;CACjB,qCAAqC;CACrC,yCAAyC;CACzC,6DAA6D;CAC7D,kBAAkB;CAClB,gBAAgB;CAEhB,sCAAsC;CACtC,gEAAgE;CAChE,sDAAsD;CACtD,oDAAoD;CACpD,qBAAqB;CACrB,mFAAmF;CACnF,cAAc;CACd,4BAA4B;CAC5B,mEAAmE;CACnE,YAAY;CACZ,UAAU;CACV,sBAAsB;CACtB,SAAS;CACT,0CAA0C;CAC1C,mDAAmD;CACnD,iDAAiD;CACjD,wBAAwB;CACxB,SAAS;CACT,OAAO;CACP,aAAa;CACb,wBAAwB;CACxB,uBAAuB;CACvB,OAAO;CACP,mDAAmD;CACnD,yCAAyC;CACzC,KAAK;CAEL,yCAAyC;CACzC,8CAA8C","debugId":null}}]
}