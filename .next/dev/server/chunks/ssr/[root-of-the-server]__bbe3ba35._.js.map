{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/pc/Desktop/LMS-Front%20Site/my-tailwind-app/app/dashboard/page.js"],"sourcesContent":["\"use client\";\r\nimport { useSession, signOut } from \"next-auth/react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Image from \"next/image\";\r\n\r\nexport default function Dashboard() {\r\n  const { data: session, status, update } = useSession(); // ðŸ‘ˆ include update()\r\n  const router = useRouter();\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  console.log(\"Dashboard session:\", session);\r\n\r\n  // âœ… Immediately refresh session after login\r\n  useEffect(() => {\r\n    if (status === \"authenticated\" && !session?.backendUser) {\r\n      // Force call to /api/auth/session\r\n      update();\r\n    }\r\n  }, [status, session, update]);\r\n\r\n  // âœ… Redirect unauthenticated users\r\n  useEffect(() => {\r\n    if (status === \"loading\") return;\r\n\r\n    if (!session) {\r\n      router.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    if (session?.backendUser) {\r\n      setIsLoading(false);\r\n    } else {\r\n      const timer = setTimeout(() => setIsLoading(false), 1000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [session, status, router]);\r\n\r\n  // âœ… Handle loading states\r\n  if (status === \"loading\" || isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-[#fffbeb] flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#A27B5C] mx-auto\"></div>\r\n          <p className=\"mt-4 text-[#6B4F4F]\">Loading your dashboard...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!session) return null;\r\n\r\n  const backendUser = session?.backendUser;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#fffbeb] p-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8\">\r\n          <h1 className=\"text-3xl font-bold text-[#3E2723] mb-6\">Dashboard</h1>\r\n\r\n          {backendUser ? (\r\n            <div className=\"bg-[#FFFDF6] border border-[#E9DCCF] rounded-lg p-6 mb-6\">\r\n              <h2 className=\"text-xl font-semibold text-[#6B4F4F] mb-4\">User Information</h2>\r\n              <div className=\"space-y-2\">\r\n                <p><strong>Name:</strong> {backendUser.name}</p>\r\n                <p><strong>Email:</strong> {backendUser.email}</p>\r\n                <p><strong>Role:</strong> {backendUser.role}</p>\r\n                {backendUser.profileImage && (\r\n                  <Image\r\n                    src={backendUser.profileImage}\r\n                    alt=\"Profile Image\"\r\n                    width={100}\r\n                    height={100}\r\n                    className=\"rounded-full mt-4\"\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6\">\r\n              <p className=\"text-yellow-800\">\r\n                User data is still loading. If this persists, please try refreshing the page.\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          <button\r\n            onClick={() => signOut({ callbackUrl: \"/login\" })}\r\n            className=\"bg-[#6B4F4F] text-white px-6 py-2 rounded-md hover:bg-[#5A4038] transition-colors\"\r\n          >\r\n            Sign Out\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n// \"use client\";\r\n// import { useSession, signOut } from \"next-auth/react\";\r\n// import { useRouter } from \"next/navigation\";\r\n// import { useEffect, useState } from \"react\";\r\n// import Image from \"next/image\";\r\n\r\n// export default function Dashboard() {\r\n//   const { data: session, status } = useSession();\r\n//   const router = useRouter();\r\n//   const [isLoading, setIsLoading] = useState(true);\r\n\r\n//   // âœ… Redirect unauthenticated users\r\n//   useEffect(() => {\r\n//     if (status === \"loading\") return;\r\n\r\n//     if (!session) {\r\n//       router.push(\"/login\");\r\n//       return;\r\n//     }\r\n\r\n//     // âœ… Wait for backendUser data to be available\r\n//     if (session?.backendUser) {\r\n//       setIsLoading(false);\r\n//     } else {\r\n//       // If backendUser is not available yet, wait a bit\r\n//       const timer = setTimeout(() => {\r\n//         setIsLoading(false);\r\n//       }, 1000);\r\n//       return () => clearTimeout(timer);\r\n//     }\r\n//   }, [session, status, router]);\r\n\r\n//   // âœ… Handle loading states\r\n//   if (status === \"loading\" || isLoading) {\r\n//     return (\r\n//       <div className=\"min-h-screen bg-[#fffbeb] flex items-center justify-center\">\r\n//         <div className=\"text-center\">\r\n//           <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#A27B5C] mx-auto\"></div>\r\n//           <p className=\"mt-4 text-[#6B4F4F]\">Loading your dashboard...</p>\r\n//         </div>\r\n//       </div>\r\n//     );\r\n//   }\r\n\r\n//   // âœ… Handle unauthenticated\r\n//   if (!session) {\r\n//     return null;\r\n//   }\r\n\r\n//   const backendUser = session?.backendUser;\r\n\r\n//   return (\r\n//     <div className=\"min-h-screen bg-[#fffbeb] p-8\">\r\n//       <div className=\"max-w-4xl mx-auto\">\r\n//         <div className=\"bg-white rounded-xl shadow-lg p-8\">\r\n//           <h1 className=\"text-3xl font-bold text-[#3E2723] mb-6\">Dashboard</h1>\r\n\r\n//           {backendUser ? (\r\n//             <div className=\"bg-[#FFFDF6] border border-[#E9DCCF] rounded-lg p-6 mb-6\">\r\n//               <h2 className=\"text-xl font-semibold text-[#6B4F4F] mb-4\">\r\n//                 User Information\r\n//               </h2>\r\n//               <div className=\"space-y-2\">\r\n//                 <p>\r\n//                   <strong>Name:</strong> {backendUser.name}\r\n//                 </p>\r\n//                 <p>\r\n//                   <strong>Email:</strong> {backendUser.email}\r\n//                 </p>\r\n//                 <p>\r\n//                   <strong>Role:</strong> {backendUser.role}\r\n//                 </p>\r\n//                 {backendUser.profileImage && (\r\n//                   <Image\r\n//                     src={backendUser.profileImage}\r\n//                     alt=\"Profile Image\"\r\n//                     width={100}\r\n//                     height={100}\r\n//                     className=\"rounded-full mt-4\"\r\n//                   />\r\n//                 )}\r\n//               </div>\r\n//             </div>\r\n//           ) : (\r\n//             <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6\">\r\n//               <p className=\"text-yellow-800\">\r\n//                 User data is still loading. If this persists, please try refreshing the page.\r\n//               </p>\r\n//             </div>\r\n//           )}\r\n\r\n//           <button\r\n//             onClick={() => signOut({ callbackUrl: \"/login\" })}\r\n//             className=\"bg-[#6B4F4F] text-white px-6 py-2 rounded-md hover:bg-[#5A4038] transition-colors\"\r\n//           >\r\n//             Sign Out\r\n//           </button>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }"],"names":[],"mappings":"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","debugId":null}}]
}